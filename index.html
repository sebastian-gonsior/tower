<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tower of Ascension</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css">
</head>

<body>


    <div id="app-root">

        <!-- SCREEN 1: THE TOWER ENTRANCE (Welcome / Login) -->
        <section id="screen-welcome" class="screen">
            <div class="tower-entrance-content">
                <h1 class="game-title">TOWER</h1>
                <div class="entrance-gate">
                    <div id="login-form">
                        <p class="entrance-prompt">Sign the Guestbook to Enter</p>
                        <input type="text" id="char-name" class="form-input" placeholder="Your Name, Adventurer">
                        <button id="create-char-btn" class="btn btn-entrance">ENTER THE TOWER</button>
                    </div>
                    <div id="welcome-back-form" class="hidden">
                        <p class="entrance-prompt">Welcome back,</p>
                        <h2 id="welcome-char-name" class="hero-name-display">Hero</h2>
                        <button id="resume-btn" class="btn btn-entrance">RESUME CLIMB</button>
                        <button id="reset-save-btn" class="btn-link">Reset Save</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCREEN 2: THE GOBLIN MERCHANT (Shop) -->
        <section id="screen-shop" class="screen hidden">
            <div class="shop-keeper-area">
                <div class="shop-keeper-sprite">üë∫</div>
                <div class="shop-speech-bubble">
                    "Got some rare wares for ya... heh heh."
                </div>
            </div>

            <div class="shop-shelves-container">
                <h2 class="shop-header">Merchant's Wares</h2>
                <div class="shop-status">
                    <span class="gold-display">üí∞ <span id="shop-gold-display">0</span></span>
                    <button id="reroll-shop-btn" class="btn btn-reroll">üé≤ Reroll (5g)</button>
                </div>

                <div id="shop-items" class="shop-items-grid">
                    <!-- Items injected by JS -->
                </div>

                <div class="shop-actions">
                    <button id="finish-shopping-btn" class="btn btn-primary">Proceed to Floor <span
                            id="next-floor-num">1</span></button>
                </div>
            </div>

            <!-- Inventory Preview -->
            <div class="shop-inventory-preview">
                <div class="inventory-preview-section">
                    <h4>‚öîÔ∏è Equipment</h4>
                    <div class="preview-slots" id="shop-active-preview"></div>
                </div>
                <div class="inventory-preview-section">
                    <h4>üéí Backpack</h4>
                    <div class="preview-slots" id="shop-stash-preview"></div>
                </div>
            </div>
        </section>

        <!-- SCREEN 3: COMBAT (The Tower Floor) -->
        <section id="screen-combat" class="screen hidden">
            <!-- Top Bar: HUD -->
            <div class="combat-hud">
                <div class="hud-left">
                    <button id="back-to-shop-btn" class="btn btn-small">üõí Shop</button>
                </div>
                <div class="hud-center">
                    <span class="floor-badge">FLOOR <span id="level-display">1</span></span>
                    <div id="combat-timer" class="combat-timer hidden">03:00</div>
                    <button id="surrender-btn" class="btn surrender-btn hidden">üè≥Ô∏è Surrender</button>
                </div>
                <div class="hud-right">
                    <span class="hud-stat">‚ù§Ô∏è <span id="lives-display">3</span></span>
                    <span class="hud-stat">üí∞ <span id="gold-display">0</span></span>
                </div>
            </div>

            <!-- Game Board -->
            <div class="game-board">
                <!-- Player Side -->
                <div class="panel player-panel">
                    <!-- Character Info Row -->
                    <div class="char-info">
                        <div class="char-portrait">
                            <div class="char-sprite player-sprite">üßô</div>
                        </div>
                        <div class="char-details">
                            <h2 class="char-name" id="player-name-display">Hero</h2>
                        </div>
                    </div>

                    <!-- Buffs & Blessings Row (Above Health Bar) -->
                    <div class="buffs-section">
                        <div class="buffs-row" id="player-buffs"></div>
                        <div class="blessings-row" id="player-blessings"></div>
                    </div>

                    <!-- HP Bar - Full Width -->
                    <div class="hp-section">
                        <div class="hp-bar-wrapper">
                            <div class="hp-bar-bg">
                                <div class="hp-bar-fill player-hp-fill" id="player-hp-bar" style="width: 100%;"></div>
                            </div>
                            <span class="hp-text" id="player-hp-text">100/100</span>
                        </div>
                    </div>

                    <!-- Debuffs Row (Below Health Bar) -->
                    <div class="status-effects">
                        <div class="debuffs-row" id="player-debuffs"></div>
                    </div>

                    <!-- Inventory Slots -->
                    <div class="inventory-section">
                        <h4 class="section-label">Equipment</h4>
                        <div class="slots-container" id="active-slots"></div>
                    </div>

                    <!-- Damage Meter -->
                    <div class="meter-section">
                        <div class="meter-header">
                            <div class="meter-tabs">
                                <span class="meter-tab active" data-target="player" data-mode="damage">Damage</span>
                                <span class="meter-tab" data-target="player" data-mode="healing">Heal</span>
                                <span class="meter-tab" data-target="player" data-mode="gold">Gold</span>
                            </div>
                            <span id="player-dps">0 DPS</span>
                        </div>
                        <div class="combat-meter" id="player-meter"></div>
                    </div>
                </div>

                <!-- VS Separator -->
                <div class="vs-separator">
                    <div class="vs-text">VS</div>
                    <button id="start-fight-btn" class="btn btn-fight">‚öîÔ∏è FIGHT</button>
                </div>

                <!-- Enemy Side -->
                <div class="panel enemy-panel">
                    <!-- Character Info Row -->
                    <div class="char-info">
                        <div class="char-details enemy-details">
                            <h2 class="char-name" id="enemy-name-display">Enemy</h2>
                        </div>
                        <div class="char-portrait">
                            <div class="char-sprite enemy-sprite">üêâ</div>
                        </div>
                    </div>

                    <!-- Buffs Row (Above Health Bar) -->
                    <div class="buffs-section">
                        <div class="buffs-row" id="enemy-buffs"></div>
                    </div>

                    <!-- HP Bar - Full Width -->
                    <div class="hp-section">
                        <div class="hp-bar-wrapper">
                            <div class="hp-bar-bg">
                                <div class="hp-bar-fill enemy-hp-fill" id="enemy-hp-bar" style="width: 100%;"></div>
                            </div>
                            <span class="hp-text" id="enemy-hp-text">1000/1000</span>
                        </div>
                    </div>

                    <!-- Debuffs Row (Below Health Bar) -->
                    <div class="status-effects">
                        <div class="debuffs-row" id="enemy-debuffs"></div>
                    </div>

                    <!-- Inventory Slots -->
                    <div class="inventory-section">
                        <h4 class="section-label">Equipment</h4>
                        <div class="slots-container" id="enemy-slots"></div>
                    </div>

                    <!-- Damage Meter -->
                    <div class="meter-section">
                        <div class="meter-header">
                            <div class="meter-tabs">
                                <span class="meter-tab active" data-target="enemy" data-mode="damage">Damage</span>
                                <span class="meter-tab" data-target="enemy" data-mode="healing">Heal</span>
                                <span class="meter-tab" data-target="enemy" data-mode="gold">Gold</span>
                            </div>
                            <span id="enemy-dps">0 DPS</span>
                        </div>
                        <div class="combat-meter" id="enemy-meter"></div>
                    </div>
                </div>
            </div>

            <!-- Bottom Stash (Inventory) -->
            <div class="stash-container">
                <h3>Backpack (Stash)</h3>
                <div class="slots-container" id="stash-slots"></div>
            </div>

            <!-- Boss Intro Overlay (Transition only) -->
            <div id="boss-intro-overlay" class="modal hidden">
                <div class="boss-card">
                    <h2>‚ö†Ô∏è BOSS ENCOUNTER ‚ö†Ô∏è</h2>
                    <h1 id="boss-intro-name">Boss</h1>
                    <div class="boss-portrait">üëπ</div>
                    <p id="boss-intro-text">"..."</p>
                    <button id="proceed-to-equip-btn" class="btn">FIGHT</button>
                </div>
            </div>
        </section>

        <!-- SCREEN 4: REWARDS (Victory and Blessing) -->
        <section id="screen-rewards" class="screen hidden">
            <div class="rewards-container">
                <h1 class="victory-title">VICTORY!</h1>
                <p class="victory-subtitle">The Boss has been slain.</p>
                <h2 class="choose-blessing">CHOOSE YOUR BLESSING</h2>

                <div class="reward-cards-container" id="reward-choices">
                    <!-- Cards injected globally by JS -->
                </div>

                <div class="rewards-footer">
                    <div class="stat-item">üíõ Lives: <span id="reward-lives">3</span></div>
                    <div class="stat-item">üí∞ Gold: <span id="reward-gold">0</span></div>
                    <div class="stat-item">üìà Income: <span id="reward-income">+0</span></div>
                </div>
            </div>
        </section>
    </div>

    <!-- Item Tooltip -->
    <div id="item-tooltip" class="item-tooltip hidden">
        <!-- Dynamic Content -->
    </div>

    <script type="module" src="js/main.js"></script>
</body>

</html>